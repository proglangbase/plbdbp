#
#   Copyright Â© 2024 Christopher Augustus
#
#   This Source Code Form is subject to the terms of the Mozilla Public
#   License, v. 2.0. If a copy of the MPL was not distributed with this
#   file, You can obtain one at http://mozilla.org/MPL/2.0/.
#
#   ËœË˜Â¨â¼âŒœÂ´Ë7âˆÂ¯â€¢Ã·Ã—   Â¬â‰âš‡âŸâ—¶âŠ˜âŠââ•âŸ¨âŸ©âˆšâ‹†   âŒ½ğ•¨âˆŠâ†‘âˆ§yâŠ”âŠâŠÏ€â†â†’    â†™ğ•â·ğ•£â‹YUâŠ‘âŠ’â³âŠ£âŠ¢
#   â‰ğ•¤â†•ğ•—ğ•˜âŠ¸âˆ˜â—‹âŸœâ‹„â†©\    â†–ğ•ŠDğ”½ğ”¾Â«JâŒ¾Â»Â·Ë™|    â¥Šğ•©â†“âˆ¨âŒŠnâ‰¡âˆ¾â‰â‰       â‹ˆğ•Câ’âŒˆNâ‰¢â‰¤â‰¥â‡
#
#   ShowWX â† { â€¢Show ğ•¨ â‹„ â€¢Show ğ•© }
#
âŸ¨ PA â‡ PlbArray,
  PI â‡ PlbArrayItem,
  PR â‡ PlbArrayRowI,
  PC â‡ PlbArrayColI,
  PS â‡ PlbArrayStyle
âŸ© â† â€¢Import "plbarray.bqn"

nl â† @+10

HtRouteIndex  â† "/"âŠ¸âˆ¾â€¢Fmt
HtAttrClass   â† "class="""âˆ¾âˆ¾âŸœ'"'
HtAttrHref    â† "href="""âˆ¾âˆ¾âŸœ'"'
HtTagWithAttr â† (("<"âŠ¸âˆ¾âŠ£)âˆ¾âŸœ' ')âˆ¾(âˆ¾âŸœ">"âŠ¢)
HtTagA        â† "a"   HtTagWithAttr HtAttrHref
HtTagTd       â† "td"  HtTagWithAttr HtAttrClass
HtWrapTagA    â† (HtTagAâŠ£)âˆ¾(âˆ¾âŸœ"</a>"âŠ¢)
HtWrapTagTd   â† (HtTagTdâŠ£)âˆ¾(âˆ¾âŸœ"</td>"âŠ¢)
HtWrapTagTr   â† "      <tr>"âŠ¸âˆ¾âˆ¾âŸœ("</tr>"âˆ¾nl)
HtWrapAnchor  â† (âŠ£(HtRouteIndexâŠ£)âŠ¸HtWrapTagA)âš‡1

CharInStyle     â† âŠ£âˆŠ(" "âŠ¸âˆ¾PSâŠ¢)
ClassFromStyle  â† (âŠ‘'i'âŠ¸CharInStyle)â—¶âŸ¨"def","ind"âŸ©
HtAnchorIfStyle â† {>((PRğ•¨)HtWrapAnchorğ•©)âŸ('r'âŠ¸CharInStyleğ•¨)ğ•©}
##HtStylizeAnchor â† >((PRâŠ£)HtWrapAnchorâŠ¢)âŸ('r'âŠ¸CharInStyleâŠ£)âŠ¢
##  TODO: ^ TACIT FORM IS WRONG

HtTableData         â† (ClassFromStyleâˆ˜âŠ£ HtWrapTagTdâš‡1 âŠ¢)âŸœ(âŠ¢ HtAnchorIfStyle PI)
HtTableRow          â† <âˆ˜HtWrapTagTrâˆ˜âˆ¾(HtTableDataË˜)
HtTableFromPlbArray â† âˆ¾Â·HtTableRowË˜âŠ¢

url     â† âŠ‘â€¢args
htTable â† HtTableFromPlbArray PA url
#â€¢Show   htTable
#â€¢Show â‰¢ htTable
#â€¢Show â‰  htTable
#â€¢Show â‰¡ htTable
#â€¢Exit 0

htDoc â† "
<!DOCTYPE html>
<html>
<head>
  <meta charset=""UTF-8"">
  <title>proglangbase</title>
  <style>
    a {
      font-weight:      bold;
    }
    body {
      background-color: #bfbfbf;
      font-family:      Arial, Helvetica, sans-serif;
      margin:           0;
      padding:          0;
    }
    header {
      background-color: #7f7f7f;
      position:         fixed;
      width:            100%;
      padding-bottom:   0.5em;
      padding-top:      0.5em;
      top:              0;
    }
    header h1 {
      color:            #cfcfcf;
      display:          inline;
      font-size:        1.0em;
      margin:           0;
      padding-left:     1.0em;
      padding-right:    0.5em;
    }
    header a {
      background-color: #bfbfbf;
      color:            #7f3f00;
      font-size:        1.0em;
      margin-left:      0.5em;
      margin-right:     0.5em;
      padding-left:     0.5em;
      padding-right:    0.5em;
      text-decoration:  none;
    }
    main {
      margin-top:       2.2em;
    }
    td {
      outline:          dotted #9f9f9f;
    }
    td a {
      color:            #7f3f00;
      text-decoration:  none;
    }
    td.def {
    }
    td.ind {
      background-color: #cfcfcf;
      padding-left:     1.0em;
    }
    td, th {
      font-size:        0.8em;
      padding-bottom:   0.2em;
      padding-left:     0.3em;
      padding-right:    0.5em;
      padding-top:      0.2em;
    }
    th {
      outline:          solid white;
    }
  </style>
<body>
  <header>
    <h1>proglangbase</h1>
    <a href=""/"">/</a>
    <a href="""âˆ¾urlâˆ¾""">"âˆ¾urlâˆ¾"</a>
  </header>
  <main>
    <table>
"âˆ¾htTableâˆ¾"    </table>
  </main>
</body>
</html>
"

â€¢Out htDoc
â€¢Exit 0

#
#   ËœË˜Â¨â¼âŒœÂ´Ë7âˆÂ¯â€¢Ã·Ã—   Â¬â‰âš‡âŸâ—¶âŠ˜âŠââ•âŸ¨âŸ©âˆšâ‹†   âŒ½ğ•¨âˆŠâ†‘âˆ§yâŠ”âŠâŠÏ€â†â†’    â†™ğ•â·ğ•£â‹YUâŠ‘âŠ’â³âŠ£âŠ¢
#   â‰ğ•¤â†•ğ•—ğ•˜âŠ¸âˆ˜â—‹âŸœâ‹„â†©\    â†–ğ•ŠDğ”½ğ”¾Â«JâŒ¾Â»Â·Ë™|    â¥Šğ•©â†“âˆ¨âŒŠnâ‰¡âˆ¾â‰â‰       â‹ˆğ•Câ’âŒˆNâ‰¢â‰¤â‰¥â‡
#
